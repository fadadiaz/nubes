<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guía de Identificación de Nubes</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:wght@400&display=swap">
  <link rel="stylesheet" href="https://use.typekit.net/oer0pgk.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=west" />
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    * {
      box-sizing: border-box;
    }

    /* Estilos base (Desktop) */
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #fff;
      font-family: 'Alegreya Sans', sans-serif;
      color: #000;
      overflow: hidden;
    }

    .card {
      text-align: center;
      display: flex;
      min-width: 330px;
      gap: 60px;
      height: 90vh;
      width: 90vw;
      transition: filter 0.5s ease, -webkit-filter 0.5s ease;
      flex-flow: wrap;
      justify-content: center;
      align-items: unset;
    }

    .card.blur {
      -webkit-filter: blur(4px);
      filter: blur(4px);
    }

    .welcome-text {
      margin: 0px;
      font-family: "ff-more-web-pro-condensed", serif;
      font-size: 99.06px;
      display: flex;
      align-items: center;
      height: 100%;
      width: 60%;
      max-width: 820px;
      z-index: 1000;
    }

    .question {
      margin: 0px;
      font-family: "ff-more-web-pro-condensed", serif;
      font-size: 99.06px;
      display: flex;
      align-items: center;
      height: 100%;
      width: 60%;
      max-width: 820px;
      z-index: 1000;
    }

    .cloud-name {
      margin: 0px;
      font-family: "ff-more-web-pro-condensed", serif;
      font-size: 99.06px;
      display: flex;
      align-items: center;
      height: 100%;
      width: 60%;
      max-width: 820px;
      font-weight: 100;
      z-index: 1000;
    }

    .description {
      font-size: 18px;
      margin: 0px;
      font-weight: 100;
      display: flex;
      align-items: center;
      z-index: 1000;
    }

    .button-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
      height: 100%;
      justify-content: center;
      width: 280px;
      max-width: unset;
      align-items: unset;
      flex-grow: unset;
    }

    .button {
      background-color: #fff;
      color: #000;
      padding: 10px;
      font-size: 20px;
      cursor: pointer;
      font-family: 'Alegreya Sans', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      border: 1px solid #000;
      letter-spacing: 0.6pt;
      position: relative;
      width: 100%;
    }

    .vamos, .si, .no, .restart {
      background-color: #fff;
      color: #000;
      padding: 10px;
      font-size: 20px;
      cursor: pointer;
      font-family: 'Alegreya Sans', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      border: 1px solid #000;
      letter-spacing: 0.6pt;
      position: relative;
      width: 100%;
    }

    .si {
      background-color: #fff;
      color: #000;
      padding: 10px;
      font-size: 20px;
      cursor: pointer;
      font-family: 'Alegreya Sans', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      border: 1px solid #000;
      letter-spacing: 0.6pt;
      position: relative;
      width: 100%;
    }

    .no {
      background-color: #fff;
      color: #000;
      padding: 10px;
      font-size: 20px;
      cursor: pointer;
      font-family: 'Alegreya Sans', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      border: 1px solid #000;
      letter-spacing: 0.6pt;
      position: relative;
      width: 100%;
    }

    .restart {
      background-color: #fff;
      color: #000;
      border: 1px solid #000;
      padding: 10px;
      font-size: 20px;
      cursor: pointer;
      font-family: 'Alegreya Sans', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      width: 100%;
      letter-spacing: 0.6pt;
      position: relative;
    }

    .back-button {
      background-color: rgb(255, 255, 255);
      color: rgb(0, 0, 0);
      border: none;
      font-size: 14px;
      cursor: pointer;
      font-family: "Alegreya Sans", sans-serif;
      position: absolute;
      width: 90vw;
      text-align: left;
    }

    .material-symbols-outlined {
      font-weight: 300;
    }

    .progress-container {
      position: fixed;
      top: 20px;
      width: 90vw;
      height: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .progress-bar {
      width: 100%;
      height: 1px;
      background-color: rgb(0, 0, 0);
      position: relative;
    }

    .progress-dot {
      width: 15px;
      height: 15px;
      background-color: rgb(0, 0, 0);
      border-radius: 50%;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      left: 0px;
      transition: left 0.5s;
    }

    .button::after, .button::before {
      content: "";
      position: absolute;
      background-color: rgb(0, 0, 0);
      pointer-events: none;
    }

    .derecha::after {
      width: 50vw;
      height: 1px;
      top: 50%;
      left: 100%;
      transform: translateY(-50%);
    }

    .abajo::after {
      width: 1px;
      height: 50vh;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
    }

    .izquierda::before {
      width: 50vw;
      height: 1px;
      top: 50%;
      right: 100%;
      transform: translateY(-50%);
    }

    /* Estilos para Mobile (≤767px) */
    @media (max-width: 767px) {
      .card {
        gap: 20px;
        width: auto;
        flex-direction: column;
        align-items: center;
        padding: 16px;
      }

      .welcome-text {
        font-size: 49.06px;
        flex: 2;
        overflow-wrap: anywhere;
        height: auto;
        width: auto;
        max-width: none;
      }

      .question {
        font-size: 49.06px;
        flex: 2;
        overflow-wrap: anywhere;
        height: auto;
        width: auto;
        max-width: none;
      }

      .cloud-name {
        font-size: 49.06px;
        flex: 2;
        overflow-wrap: anywhere;
        height: auto;
        width: auto;
        max-width: none;
      }

      .description {
        flex: 1;
      }

      .button-container {
        max-width: 100vw;
        align-items: center;
        flex-grow: 1;
      }

      .button {
        width: 50vw;
      }

      .vamos, .si, .no, .restart {
        width: 50vw;
      }

      .si {
        width: 50vw;
      }

      .no {
        width: 50vw;
      }

      .restart {
        width: 50vw;
      }

      .back-button {
        position: static;
        width: auto;
        text-align: center;
        display: flex;
        align-items: center;
        gap: 5px;
      }
    }
  </style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar">
      <div class="progress-dot" id="progress-dot"></div>
    </div>
  </div>
  <div class="card" id="card">
    <p class="welcome-text">Identificador de Nubes</p>
    <div class="button-container" id="buttons">
      <button class="button vamos" onclick="startQuiz()">¡Vamos!</button>
    </div>
  </div>

  <script>
    let currentState = "welcome";
    let history = [];
    const maxSteps = 5;

    const decisionTree = {
      welcome: {
        action: "start"
      },
      q1: {
        question: "¿Se ven rayos o se oyen truenos?",
        yes: {
          result: {
            name: "Cumulonimbus",
            description: "Nube en forma de enorme torre, a veces con yunque. Posibilidad de tormenta."
          }
        },
        no: "q2"
      },
      q2: {
        question: "¿Se ven claramente protuberancias o cúpulas?",
        yes: "q3",
        no: "q4"
      },
      q3: {
        question: "En el tercio alto de esta nube, ¿es nítido el contorno?",
        yes: {
          result: {
            name: "Cumulonimbus",
            description: "Nube en forma de enorme torre, a veces con yunque. Posibilidad de tormenta."
          }
        },
        no: {
          result: {
            name: "Cumulus",
            description: "Nube de aspecto algodonoso y separada de otras nubes, con contornos bien delimitados."
          }
        }
      },
      q4: {
        question: "¿Se observa una capa uniforme, continua o discontinua, sin rodillos ni elementos distintivos?",
        yes: "q5",
        no: "q6"
      },
      q5: {
        question: "¿Aparecen el Sol o la Luna en forma de parche luminoso?",
        yes: {
          result: {
            name: "Cirrostratus",
            description: "Velo nuboso transparente, de aspecto blanquecino o fibroso, que no tapa las sombras, da lugar al fenómeno del halo. (Nube de tipo stratus)"
          }
        },
        no: "q7"
      },
      q7: {
        question: "¿Observa una capa alta en forma de lámina y de color gris o entre azulado y oscuro?",
        yes: {
          result: {
            name: "Altostratus",
            description: "Capa nubosa alargada y uniforme, que tapa las sombras aun cuando se pueden ver el Sol o la Luna vagamente, como a través de un vidrio deslustrado. (Nube de tipo stratus)"
          }
        },
        no: "q8"
      },
      q8: {
        question: "¿Hay una capa baja densa y alargada poco definida que puede traer precipitaciones?",
        yes: {
          result: {
            name: "Nimbostratus",
            description: "Nube oscura de lluvia o nube clara de nieve. Suele traer precipitaciones continuas de lluvia, nieve o gránulos de hielo. (Nube de tipo stratus)"
          }
        },
        no: {
          result: {
            name: "Stratus",
            description: "Capa gris blanquecina en el nivel bajo, que puede generar llovizna o nieve en granos. Cuando el Sol o la Luna son visibles, su contorno está definido. Puede estar formado por elementos separados. (Nube de tipo stratus)"
          }
        }
      },
      q6: {
        question: "¿Hay filamentos o fibras blancos y finos?",
        yes: {
          result: {
            name: "Cirrus",
            description: "Ganchos, plumas, bandas o bancos con un brillo sedoso."
          }
        },
        no: "q9"
      },
      q9: {
        question: "¿Son todos los elementos pequeños que un dedo (brazo estirado)?",
        yes: {
          result: {
            name: "Cirrocumulus",
            description: "Capa delgada de pequeños gránulos u ondas, de color blanco puro, situados en el nivel alto. Tamaño < 1°."
          }
        },
        no: "q10"
      },
      q10: {
        question: "¿Son todos los elementos redondos del tamaño de 1 a 3 dedos (brazo estirado)?",
        yes: {
          result: {
            name: "Altocumulus",
            description: "Banco, manto o capa estructurado de nubes blancas o grises (de torreta, lenticulares o aborregadas), con ondulaciones o rodillos. Anchura: entre 1 – 3°."
          }
        },
        no: {
          result: {
            name: "Stratocumulus",
            description: "Campo, rodillo o bulto de nubes grises o blanquecinas, con contornos redondeados y situadas en el nivel bajo. Elementos dispuestos de forma regular. Anchura: 5 – 10° (5 dedos)."
          }
        }
      }
    };

    function startQuiz() {
      const card = document.getElementById("card");
      card.classList.add("blur");

      setTimeout(() => {
        card.innerHTML = '';
        setTimeout(() => {
          currentState = "q1";
          displayQuestion();
          updateProgress();
          toggleBackButton();
          card.classList.remove("blur");
        }, 100);
      }, 500);
    }

    function answer(response) {
      const card = document.getElementById("card");
      card.classList.add("blur");

      setTimeout(() => {
        card.innerHTML = '';
        setTimeout(() => {
          history.push({ state: currentState, response: response });
          const currentNode = decisionTree[currentState];
          const next = currentNode[response];

          if (typeof next === "string") {
            currentState = next;
            displayQuestion();
          } else if (next && next.result) {
            displayResult(next.result);
          }
          updateProgress();
          toggleBackButton();
          card.classList.remove("blur");
        }, 100);
      }, 500);
    }

    function goBack() {
      if (history.length > 0) {
        const card = document.getElementById("card");
        card.classList.add("blur");

        setTimeout(() => {
          card.innerHTML = '';
          setTimeout(() => {
            history.pop();
            const previous = history.length > 0 ? history[history.length - 1] : null;
            if (previous) {
              currentState = previous.state;
              displayQuestion();
            } else {
              currentState = "q1";
              displayQuestion();
            }
            updateProgress();
            toggleBackButton();
            card.classList.remove("blur");
          }, 100);
        }, 500);
      }
    }

    function displayQuestion() {
      const card = document.getElementById("card");
      card.innerHTML = `
        <button id="back-btn" class="back-button" onclick="goBack()" style="display: none;">
          <span class="material-symbols-outlined">west</span>
        </button>
        <p class="question" id="question">${decisionTree[currentState].question}</p>
        <div class="button-container" id="buttons">
          <button id="${currentState}-yes" class="button derecha si" onclick="answer('yes')">Sí</button>
          <button id="${currentState}-no" class="button abajo no" onclick="answer('no')">No</button>
        </div>
      `;
    }

    function displayResult(result) {
      const card = document.getElementById("card");
      card.innerHTML = `
        <button id="back-btn" class="back-button" onclick="goBack()" style="display: none;">
          <span class="material-symbols-outlined">west</span>
        </button>
        <h2 class="cloud-name">${result.name}</h2>
        <div class="description">${result.description}</div>
        <div class="button-container" id="buttons">
          <button id="restart-btn" class="button restart" onclick="restart()">Volver a empezar</button>
        </div>
      `;
    }

    function restart() {
      const card = document.getElementById("card");
      card.classList.add("blur");

      setTimeout(() => {
        card.innerHTML = '';
        setTimeout(() => {
          currentState = "q1";
          history = [];
          displayQuestion();
          updateProgress();
          toggleBackButton();
          card.classList.remove("blur");
        }, 100);
      }, 500);
    }

    function updateProgress() {
      const progressDot = document.getElementById("progress-dot");
      const progressBarWidth = document.querySelector(".progress-bar").offsetWidth;
      const steps = history.length;
      const isResult = decisionTree[currentState].result !== undefined;

      const progressPercent = isResult ? 100 : (steps / maxSteps) * 100;
      const dotPosition = (progressPercent / 100) * (progressBarWidth - 7.5);

      progressDot.style.left = `${dotPosition}px`;
    }

    function toggleBackButton() {
      const backButton = document.getElementById("back-btn");
      const isResult = decisionTree[currentState].result !== undefined;
      backButton.style.display = (history.length > 0 && !isResult) ? "block" : "none";
    }

    updateProgress();
    toggleBackButton();
  </script>
</body>
</html>
